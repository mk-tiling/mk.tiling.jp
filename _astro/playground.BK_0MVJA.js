import{u as c}from"./jsxRuntime.module.DB2A7u23.js";import{d as et,y as st,q as P,T as W}from"./hooks.module.DmNZ1Wmu.js";import{k as lt}from"./preact.module.Drh4-Z9x.js";const V=({label:o,value:d,min:y=0,max:g=10,step:N=1,onChange:f})=>{const D=`slider-${o.replace(/\s+/g,"-").toLowerCase()}`,S=()=>f(Math.max(y,d-N)),b=()=>f(Math.min(g,d+N)),r=d>y,M=d<g;return c("div",{children:[c("label",{for:D,className:"block w-full text-sm",children:[o,": ",d]}),c("div",{className:"flex items-center gap-2",children:[c("button",{className:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:enabled:bg-blue-200 disabled:opacity-50","aria-label":"Decrease",disabled:!r,onClick:S,children:"−"}),c("input",{id:D,type:"range",min:y,max:g,step:N,value:d,onInput:x=>f(Number(x.currentTarget.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),c("button",{className:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:enabled:bg-blue-200 disabled:opacity-50","aria-label":"Increase",disabled:!M,onClick:b,children:"＋"})]})]})},at=({enabled:o,onToggle:d,label:y})=>c("div",{className:"py-2 flex items-center gap-1",children:[y&&c("span",{className:"text-sm",children:[y,":"]}),c("button",{type:"button",role:"switch","aria-checked":o,"aria-label":y,onClick:()=>d(!o),className:`w-12 h-6 rounded-full px-1 flex items-center transition-colors ${o?"bg-blue-500":"bg-gray-200"}`,children:c("span",{className:`w-4 h-4 rounded-full bg-white transform transition-transform ${o?"translate-x-6":"translate-x-0"}`})})]});var dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ft(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ct={exports:{}};(function(o,d){(function(y,g){o.exports=g()})(dt,function(){var y=1e3,g=6e4,N=36e5,f="millisecond",D="second",S="minute",b="hour",r="day",M="week",x="month",k="quarter",_="year",I="date",H="Invalid Date",X=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var e=["th","st","nd","rd"],t=i%100;return"["+i+(e[(t-20)%10]||e[t]||e[0])+"]"}},U=function(i,e,t){var a=String(i);return!a||a.length>=e?i:""+Array(e+1-a.length).join(t)+i},J={s:U,z:function(i){var e=-i.utcOffset(),t=Math.abs(e),a=Math.floor(t/60),n=t%60;return(e<=0?"+":"-")+U(a,2,"0")+":"+U(n,2,"0")},m:function i(e,t){if(e.date()<t.date())return-i(t,e);var a=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(a,x),u=t-n<0,l=e.clone().add(a+(u?-1:1),x);return+(-(a+(t-n)/(u?n-l:l-n))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:x,y:_,w:M,d:r,D:I,h:b,m:S,s:D,ms:f,Q:k}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},p="en",s={};s[p]=q;var h="$isDayjsObject",T=function(i){return i instanceof A||!(!i||!i[h])},v=function i(e,t,a){var n;if(!e)return p;if(typeof e=="string"){var u=e.toLowerCase();s[u]&&(n=u),t&&(s[u]=t,n=u);var l=e.split("-");if(!n&&l.length>1)return i(l[0])}else{var w=e.name;s[w]=e,n=w}return!a&&n&&(p=n),n||!a&&p},$=function(i,e){if(T(i))return i.clone();var t=typeof e=="object"?e:{};return t.date=i,t.args=arguments,new A(t)},m=J;m.l=v,m.i=T,m.w=function(i,e){return $(i,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var A=function(){function i(t){this.$L=v(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[h]=!0}var e=i.prototype;return e.parse=function(t){this.$d=function(a){var n=a.date,u=a.utc;if(n===null)return new Date(NaN);if(m.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var l=n.match(X);if(l){var w=l[2]-1||0,O=(l[7]||"0").substring(0,3);return u?new Date(Date.UTC(l[1],w,l[3]||1,l[4]||0,l[5]||0,l[6]||0,O)):new Date(l[1],w,l[3]||1,l[4]||0,l[5]||0,l[6]||0,O)}}return new Date(n)}(t),this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return m},e.isValid=function(){return this.$d.toString()!==H},e.isSame=function(t,a){var n=$(t);return this.startOf(a)<=n&&n<=this.endOf(a)},e.isAfter=function(t,a){return $(t)<this.startOf(a)},e.isBefore=function(t,a){return this.endOf(a)<$(t)},e.$g=function(t,a,n){return m.u(t)?this[a]:this.set(n,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,a){var n=this,u=!!m.u(a)||a,l=m.p(t),w=function(z,L){var R=m.w(n.$u?Date.UTC(n.$y,L,z):new Date(n.$y,L,z),n);return u?R:R.endOf(r)},O=function(z,L){return m.w(n.toDate()[z].apply(n.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(L)),n)},E=this.$W,C=this.$M,F=this.$D,Z="set"+(this.$u?"UTC":"");switch(l){case _:return u?w(1,0):w(31,11);case x:return u?w(1,C):w(0,C+1);case M:var K=this.$locale().weekStart||0,G=(E<K?E+7:E)-K;return w(u?F-G:F+(6-G),C);case r:case I:return O(Z+"Hours",0);case b:return O(Z+"Minutes",1);case S:return O(Z+"Seconds",2);case D:return O(Z+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,a){var n,u=m.p(t),l="set"+(this.$u?"UTC":""),w=(n={},n[r]=l+"Date",n[I]=l+"Date",n[x]=l+"Month",n[_]=l+"FullYear",n[b]=l+"Hours",n[S]=l+"Minutes",n[D]=l+"Seconds",n[f]=l+"Milliseconds",n)[u],O=u===r?this.$D+(a-this.$W):a;if(u===x||u===_){var E=this.clone().set(I,1);E.$d[w](O),E.init(),this.$d=E.set(I,Math.min(this.$D,E.daysInMonth())).$d}else w&&this.$d[w](O);return this.init(),this},e.set=function(t,a){return this.clone().$set(t,a)},e.get=function(t){return this[m.p(t)]()},e.add=function(t,a){var n,u=this;t=Number(t);var l=m.p(a),w=function(C){var F=$(u);return m.w(F.date(F.date()+Math.round(C*t)),u)};if(l===x)return this.set(x,this.$M+t);if(l===_)return this.set(_,this.$y+t);if(l===r)return w(1);if(l===M)return w(7);var O=(n={},n[S]=g,n[b]=N,n[D]=y,n)[l]||1,E=this.$d.getTime()+t*O;return m.w(E,this)},e.subtract=function(t,a){return this.add(-1*t,a)},e.format=function(t){var a=this,n=this.$locale();if(!this.isValid())return n.invalidDate||H;var u=t||"YYYY-MM-DDTHH:mm:ssZ",l=m.z(this),w=this.$H,O=this.$m,E=this.$M,C=n.weekdays,F=n.months,Z=n.meridiem,K=function(L,R,Q,tt){return L&&(L[R]||L(a,u))||Q[R].slice(0,tt)},G=function(L){return m.s(w%12||12,L,"0")},z=Z||function(L,R,Q){var tt=L<12?"AM":"PM";return Q?tt.toLowerCase():tt};return u.replace(Y,function(L,R){return R||function(Q){switch(Q){case"YY":return String(a.$y).slice(-2);case"YYYY":return m.s(a.$y,4,"0");case"M":return E+1;case"MM":return m.s(E+1,2,"0");case"MMM":return K(n.monthsShort,E,F,3);case"MMMM":return K(F,E);case"D":return a.$D;case"DD":return m.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return K(n.weekdaysMin,a.$W,C,2);case"ddd":return K(n.weekdaysShort,a.$W,C,3);case"dddd":return C[a.$W];case"H":return String(w);case"HH":return m.s(w,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return z(w,O,!0);case"A":return z(w,O,!1);case"m":return String(O);case"mm":return m.s(O,2,"0");case"s":return String(a.$s);case"ss":return m.s(a.$s,2,"0");case"SSS":return m.s(a.$ms,3,"0");case"Z":return l}return null}(L)||l.replace(":","")})},e.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},e.diff=function(t,a,n){var u,l=this,w=m.p(a),O=$(t),E=(O.utcOffset()-this.utcOffset())*g,C=this-O,F=function(){return m.m(l,O)};switch(w){case _:u=F()/12;break;case x:u=F();break;case k:u=F()/3;break;case M:u=(C-E)/6048e5;break;case r:u=(C-E)/864e5;break;case b:u=C/N;break;case S:u=C/g;break;case D:u=C/y;break;default:u=C}return n?u:m.a(u)},e.daysInMonth=function(){return this.endOf(x).$D},e.$locale=function(){return s[this.$L]},e.locale=function(t,a){if(!t)return this.$L;var n=this.clone(),u=v(t,a,!0);return u&&(n.$L=u),n},e.clone=function(){return m.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},i}(),B=A.prototype;return $.prototype=B,[["$ms",f],["$s",D],["$m",S],["$H",b],["$W",r],["$M",x],["$y",_],["$D",I]].forEach(function(i){B[i[1]]=function(e){return this.$g(e,i[0],i[1])}}),$.extend=function(i,e){return i.$i||(i(e,A,$),i.$i=!0),$},$.locale=v,$.isDayjs=T,$.unix=function(i){return $(1e3*i)},$.en=s[p],$.Ls=s,$.p={},$})})(ct);var ht=ct.exports;const nt=ft(ht),mt=3e4,$t=()=>{const[o,d]=et(!1),[y,g]=et("");st(()=>{const f=localStorage.getItem("lastKofiPrompt");if(!f||nt().diff(nt(f),"day")>=3){const D=setTimeout(()=>{d(!0),localStorage.setItem("lastKofiPrompt",nt().format("YYYYMMDD"))},mt);return()=>{clearTimeout(D)}}},[]),st(()=>{g(o?"translate-y-0 opacity-100":"translate-y-2 opacity-0")},[o]);const N=P(()=>{window.open("https://ko-fi.com/mk_tiling","_blank"),d(!1)},[]);return o?c("div",{className:`absolute bottom-4 right-4 transition-all duration-50 ${y}`,children:c("button",{className:"h-10 flex justify-center items-center rounded-full border md:border-2 border-neutral-900 bg-white px-3 text-neutral-900 hover:enabled:bg-blue-500 hover:enabled:text-white",onClick:N,children:["Enjoying exploring?",c("span",{className:"ml-1 font-bold",children:"Support on Ko-fi!"})]})}):null};function yt(o,d,y="application/octet-stream"){const g=new Blob([o],{type:y}),N=URL.createObjectURL(g),f=document.createElement("a");f.href=N,f.download=d,f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(N)}const pt=`0
SECTION
2
HEADER
0
ENDSEC
0
SECTION
2
TABLES
0
ENDSEC
0
SECTION
2
BLOCKS
0
ENDSEC
0
SECTION
2
ENTITIES`,gt=`0
ENDSEC
0
EOF`;function bt(o){return[pt,"0","LWPOLYLINE","8","0","90",`${o.length}`,"70","1",...o.map(([y,g])=>["10",y.toFixed(6),"20",g.toFixed(6)]).flat(),gt].join(`
`)}const ut=(o,d)=>o%d?ut(d,o%d):d,j=(o,d=0)=>Array.from({length:o},(y,g)=>d+g),xt=({x:o,y:d})=>`l${o.toFixed(4)} ${d.toFixed(4)}`,Mt=({x:o,y:d,r:y,sweep:g=!1})=>`a${y.toFixed(4)} ${y.toFixed(4)} 0 0 ${g?1:0} ${o.toFixed(4)} ${d.toFixed(4)}`,rt=(o,d)=>`translate(${o.toFixed(4)} ${d.toFixed(4)})`,vt=o=>`rotate(${o.toFixed(4)})`,wt=({m:o,k:d,n:y,offset:g,arc:N,unit:f,layer:D})=>{const S=ut(o,d),b=o/S,r=d/S,M=y/S,x=W(()=>j(M).map(s=>f*Math.cos(2*Math.PI*s/M)),[M,f]),k=W(()=>j(M).map(s=>f*Math.sin(2*Math.PI*s/M)),[M,f]),_=W(()=>j(r).map(s=>x[s]).reduce((s,h)=>s+h),[r,x]),I=W(()=>j(r).map(s=>k[s]).reduce((s,h)=>s+h),[r,k]),H=W(()=>x[r]-x[0],[r,x]),X=W(()=>k[r]-k[0],[r,k]),Y=f/2/Math.sin(b*Math.PI/M),q=W(()=>{const s=N?Mt:xt;return[...j(r).map(h=>s({x:x[h*b%r],y:k[h*b%r],r:Y,sweep:!0})),s({x:x[r],y:k[r],r:Y,sweep:!0}),s({x:-x[0],y:-k[0],r:Y}),...j(r-1,1).map(h=>s({x:-x[(r-h)*b%r],y:-k[(r-h)*b%r],r:Y})),s({x:-x[r],y:-k[r],r:Y})].join("")},[b,r,N,x,k,Y]),U=P(s=>{const h=j(r).findIndex(T=>T*b%r==s%r);return j(h>=0?h:0).reduce(({x:T,y:v},$)=>({x:T+x[(($*b+r-s%r)%r+s)%M],y:v+k[(($*b+r-s%r)%r+s)%M]}),{x:0,y:0})},[b,r,M,x,k]),J=W(()=>{const s=2*Math.PI/M;return[...j(r).map(h=>[Math.cos(h*b%r*s),Math.sin(h*b%r*s)]),[Math.cos(r*s),Math.sin(r*s)],[-1,0],...j(r-1,1).map(h=>[-Math.cos((r-h)*b%r*s),-Math.sin((r-h)*b%r*s)])].reduce((h,[T,v])=>{const[$,m]=h.at(-1);return[...h,[$+T,m+v]]},[[0,0]])},[b,r,M]),p=P(()=>{yt(bt(J),"tile.dxf","application/dxf")},[J]);return c(lt,{children:[c("div",{className:"relative -mx-4 md:mx-0 mb-1 md:mb-2",children:[c("svg",{viewBox:"-400 -400 800 800",className:"w-full h-auto",children:[c("rect",{x:"-400",y:"-400",width:"800",height:"800",className:"fill-blue-50"}),c("defs",{children:[c("path",{id:"prototile",d:`M0 0${q}z`}),c("g",{id:"wedge",children:j(D).map(s=>j(s+1).map(h=>c("g",{transform:rt(s*_+h*H,s*I+h*X),children:c("use",{href:"#prototile"})})))})]}),c("g",{className:"stroke-2 stroke-neutral-900 fill-white","stroke-linejoin":"round",transform:`scale(1 -1) ${rt(g?-f/2:0,0)}`,children:j(M).map(s=>{const{sx:h,sy:T}=(()=>{if(g&&2*s>=M){const{x:v,y:$}=U(s-M/2);return{sx:f-v,sy:-$}}else{const{x:v,y:$}=U(s);return{sx:v,sy:$}}})();return c("g",{transform:`${rt(h,T)} ${vt(360*s/M)}`,children:c("use",{href:"#wedge",className:"hover:fill-blue-500"})})})})]}),c($t,{})]}),c("div",{className:"relative mb-1 md:mb-2 flex justify-center items-center",children:[c("span",{children:["(m, k, n) = (",o,", ",d,", ",y,")",S>1&&"*"]}),c("a",{className:"absolute right-0 px-1 cursor-pointer hidden md:inline",onClick:p,children:"DXF"})]})]})},it={k:[2,50],t:[2,10],unit:[5,50,5],layer:[1,10]},ot=(o,d,y,g)=>d<=o&&o<=y&&(g==null||g>0&&(o-d)%g==0),St=()=>{const[o,d]=et(!0),[y,g]=et({m:3,k:7,t:2,offset:!1,arc:!1,unit:20,layer:3}),N=P(p=>{const{m:s,k:h,t:T,offset:v,arc:$,unit:m,layer:A}=p,B=new URLSearchParams(Object.fromEntries(Object.entries({m:s,k:h,t:T,offset:v,arc:$,unit:m,layer:A}).filter(i=>i[1]!=null).map(([i,e])=>[i,e.toString()]))).toString();B!==location.hash&&history.replaceState(null,"",`#${B}`)},[]);st(()=>{const p=location.hash.replace(/^#/,""),{m:s,...h}=Object.fromEntries(new URLSearchParams(p).entries()),T=Object.fromEntries(Object.entries(h).map(([v,$])=>{if(["offset","arc"].includes(v))return["true","false"].includes($)?[v,$==="true"]:void 0;if(!Object.keys(it).includes(v)||!$.match(/\d+/))return null;const m=Number($),[A,B,i]=it[v];return ot(m,A,B,i)?[v,m]:null}).filter(v=>v!=null));if(s?.match(/\d+/)){const v=Number(s);ot(v,1,(T.k??y.k)-1)&&(T.m=v)}Object.keys(T).length>0&&g(v=>({...v,...T})),N(T),d(!1)},[]);const f=P(p=>{g(h=>({...h,...p}));const s=location.hash.replace(/^#/,"");N(Object.fromEntries([...new URLSearchParams(s).entries(),...Object.entries(p)]))},[]),{m:D,k:S,t:b,offset:r,arc:M,unit:x,layer:k}=y,_=r?2*(b*S-D):b*S,I=P(p=>{p<S&&f({m:p})},[S]),H=P(p=>{D>=p?f({m:p-1,k:p}):f({k:p})},[D]),X=P(p=>{f({t:p})},[]),Y=P(p=>{f({offset:p})},[]),q=P(p=>{f({arc:p})},[]),U=P(p=>{f({unit:p})},[]),J=P(p=>{f({layer:p})},[]);return{isLoading:o,m:D,k:S,t:b,n:_,offset:r,arc:M,unit:x,layer:k,setM:I,setK:H,setT:X,setOffset:Y,setArc:q,setUnit:U,setLayer:J}},Nt=()=>{const{isLoading:o,m:d,k:y,t:g,n:N,offset:f,arc:D,unit:S,layer:b,setM:r,setK:M,setT:x,setOffset:k,setArc:_,setUnit:I,setLayer:H}=St();return o?c("div",{children:"Loading..."}):c("div",{children:[c(wt,{m:d,k:y,n:N,offset:f,arc:D,unit:S,layer:b}),c("div",{className:"flex flex-col items-center",children:c("div",{className:"w-full max-w-[480px] flex flex-col gap-1 md:gap-2",children:[c(V,{label:"m",value:d,min:1,max:y-1,onChange:r}),c(V,{label:"k",value:y,min:2,max:50,onChange:M}),c(V,{label:"t",value:g,min:2,max:10,onChange:x}),c("div",{className:"w-full flex justify-evenly",children:[c(at,{label:"offset",enabled:f,onToggle:k}),c(at,{label:"arc",enabled:D,onToggle:_})]}),c("hr",{className:"my-1 md:my-2"}),c(V,{label:"unit",value:S,min:5,max:50,step:5,onChange:I}),c(V,{label:"layer",value:b,min:1,max:10,onChange:H})]})})]})};export{Nt as Playground};
