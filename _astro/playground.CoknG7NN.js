import{l as ae,k as de}from"./preact.module.IXEx8GmD.js";import{d as te,y as se,q as P,T as W}from"./hooks.module.Bgg2LTvM.js";var fe=0;function u(a,c,m,g,_,f){c||(c={});var M,b,h=c;if("ref"in h)for(b in h={},c)b=="ref"?M=c[b]:h[b]=c[b];var r={type:a,props:h,key:m,ref:M,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--fe,__i:-1,__u:0,__source:_,__self:f};if(typeof a=="function"&&(M=a.defaultProps))for(b in M)h[b]===void 0&&(h[b]=M[b]);return ae.vnode&&ae.vnode(r),r}const V=({label:a,value:c,min:m=0,max:g=10,step:_=1,onChange:f})=>{const M=`slider-${a.replace(/\s+/g,"-").toLowerCase()}`,b=()=>f(Math.max(m,c-_)),h=()=>f(Math.min(g,c+_)),r=c>m,w=c<g;return u("div",{children:[u("label",{for:M,className:"block w-full text-sm",children:[a,": ",c]}),u("div",{className:"flex items-center gap-2",children:[u("button",{className:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:enabled:bg-blue-200 disabled:opacity-50","aria-label":"Decrease",disabled:!r,onClick:b,children:"−"}),u("input",{id:M,type:"range",min:m,max:g,step:_,value:c,onInput:v=>f(Number(v.currentTarget.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),u("button",{className:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:enabled:bg-blue-200 disabled:opacity-50","aria-label":"Increase",disabled:!w,onClick:h,children:"＋"})]})]})},ie=({enabled:a,onToggle:c,label:m})=>u("div",{className:"py-2 flex items-center gap-1",children:[m&&u("span",{className:"text-sm",children:[m,":"]}),u("button",{type:"button",role:"switch","aria-checked":a,"aria-label":m,onClick:()=>c(!a),className:`w-12 h-6 rounded-full px-1 flex items-center transition-colors ${a?"bg-blue-500":"bg-gray-200"}`,children:u("span",{className:`w-4 h-4 rounded-full bg-white transform transition-transform ${a?"translate-x-6":"translate-x-0"}`})})]});var he=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function me(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ue={exports:{}};(function(a,c){(function(m,g){a.exports=g()})(he,function(){var m=1e3,g=6e4,_=36e5,f="millisecond",M="second",b="minute",h="hour",r="day",w="week",v="month",k="quarter",C="year",I="date",H="Invalid Date",X=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(o){var t=["th","st","nd","rd"],e=o%100;return"["+o+(t[(e-20)%10]||t[e]||t[0])+"]"}},U=function(o,t,e){var i=String(o);return!i||i.length>=t?o:""+Array(t+1-i.length).join(e)+o},J={s:U,z:function(o){var t=-o.utcOffset(),e=Math.abs(t),i=Math.floor(e/60),n=e%60;return(t<=0?"+":"-")+U(i,2,"0")+":"+U(n,2,"0")},m:function o(t,e){if(t.date()<e.date())return-o(e,t);var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,v),l=e-n<0,d=t.clone().add(i+(l?-1:1),v);return+(-(i+(e-n)/(l?n-d:d-n))||0)},a:function(o){return o<0?Math.ceil(o)||0:Math.floor(o)},p:function(o){return{M:v,y:C,w,d:r,D:I,h,m:b,s:M,ms:f,Q:k}[o]||String(o||"").toLowerCase().replace(/s$/,"")},u:function(o){return o===void 0}},x="en",s={};s[x]=q;var p="$isDayjsObject",N=function(o){return o instanceof A||!(!o||!o[p])},S=function o(t,e,i){var n;if(!t)return x;if(typeof t=="string"){var l=t.toLowerCase();s[l]&&(n=l),e&&(s[l]=e,n=l);var d=t.split("-");if(!n&&d.length>1)return o(d[0])}else{var D=t.name;s[D]=t,n=D}return!i&&n&&(x=n),n||!i&&x},$=function(o,t){if(N(o))return o.clone();var e=typeof t=="object"?t:{};return e.date=o,e.args=arguments,new A(e)},y=J;y.l=S,y.i=N,y.w=function(o,t){return $(o,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var A=function(){function o(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[p]=!0}var t=o.prototype;return t.parse=function(e){this.$d=function(i){var n=i.date,l=i.utc;if(n===null)return new Date(NaN);if(y.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var d=n.match(X);if(d){var D=d[2]-1||0,O=(d[7]||"0").substring(0,3);return l?new Date(Date.UTC(d[1],D,d[3]||1,d[4]||0,d[5]||0,d[6]||0,O)):new Date(d[1],D,d[3]||1,d[4]||0,d[5]||0,d[6]||0,O)}}return new Date(n)}(e),this.init()},t.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},t.$utils=function(){return y},t.isValid=function(){return this.$d.toString()!==H},t.isSame=function(e,i){var n=$(e);return this.startOf(i)<=n&&n<=this.endOf(i)},t.isAfter=function(e,i){return $(e)<this.startOf(i)},t.isBefore=function(e,i){return this.endOf(i)<$(e)},t.$g=function(e,i,n){return y.u(e)?this[i]:this.set(n,e)},t.unix=function(){return Math.floor(this.valueOf()/1e3)},t.valueOf=function(){return this.$d.getTime()},t.startOf=function(e,i){var n=this,l=!!y.u(i)||i,d=y.p(e),D=function(z,L){var R=y.w(n.$u?Date.UTC(n.$y,L,z):new Date(n.$y,L,z),n);return l?R:R.endOf(r)},O=function(z,L){return y.w(n.toDate()[z].apply(n.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(L)),n)},T=this.$W,E=this.$M,F=this.$D,Z="set"+(this.$u?"UTC":"");switch(d){case C:return l?D(1,0):D(31,11);case v:return l?D(1,E):D(0,E+1);case w:var K=this.$locale().weekStart||0,G=(T<K?T+7:T)-K;return D(l?F-G:F+(6-G),E);case r:case I:return O(Z+"Hours",0);case h:return O(Z+"Minutes",1);case b:return O(Z+"Seconds",2);case M:return O(Z+"Milliseconds",3);default:return this.clone()}},t.endOf=function(e){return this.startOf(e,!1)},t.$set=function(e,i){var n,l=y.p(e),d="set"+(this.$u?"UTC":""),D=(n={},n[r]=d+"Date",n[I]=d+"Date",n[v]=d+"Month",n[C]=d+"FullYear",n[h]=d+"Hours",n[b]=d+"Minutes",n[M]=d+"Seconds",n[f]=d+"Milliseconds",n)[l],O=l===r?this.$D+(i-this.$W):i;if(l===v||l===C){var T=this.clone().set(I,1);T.$d[D](O),T.init(),this.$d=T.set(I,Math.min(this.$D,T.daysInMonth())).$d}else D&&this.$d[D](O);return this.init(),this},t.set=function(e,i){return this.clone().$set(e,i)},t.get=function(e){return this[y.p(e)]()},t.add=function(e,i){var n,l=this;e=Number(e);var d=y.p(i),D=function(E){var F=$(l);return y.w(F.date(F.date()+Math.round(E*e)),l)};if(d===v)return this.set(v,this.$M+e);if(d===C)return this.set(C,this.$y+e);if(d===r)return D(1);if(d===w)return D(7);var O=(n={},n[b]=g,n[h]=_,n[M]=m,n)[d]||1,T=this.$d.getTime()+e*O;return y.w(T,this)},t.subtract=function(e,i){return this.add(-1*e,i)},t.format=function(e){var i=this,n=this.$locale();if(!this.isValid())return n.invalidDate||H;var l=e||"YYYY-MM-DDTHH:mm:ssZ",d=y.z(this),D=this.$H,O=this.$m,T=this.$M,E=n.weekdays,F=n.months,Z=n.meridiem,K=function(L,R,Q,ee){return L&&(L[R]||L(i,l))||Q[R].slice(0,ee)},G=function(L){return y.s(D%12||12,L,"0")},z=Z||function(L,R,Q){var ee=L<12?"AM":"PM";return Q?ee.toLowerCase():ee};return l.replace(Y,function(L,R){return R||function(Q){switch(Q){case"YY":return String(i.$y).slice(-2);case"YYYY":return y.s(i.$y,4,"0");case"M":return T+1;case"MM":return y.s(T+1,2,"0");case"MMM":return K(n.monthsShort,T,F,3);case"MMMM":return K(F,T);case"D":return i.$D;case"DD":return y.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return K(n.weekdaysMin,i.$W,E,2);case"ddd":return K(n.weekdaysShort,i.$W,E,3);case"dddd":return E[i.$W];case"H":return String(D);case"HH":return y.s(D,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return z(D,O,!0);case"A":return z(D,O,!1);case"m":return String(O);case"mm":return y.s(O,2,"0");case"s":return String(i.$s);case"ss":return y.s(i.$s,2,"0");case"SSS":return y.s(i.$ms,3,"0");case"Z":return d}return null}(L)||d.replace(":","")})},t.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},t.diff=function(e,i,n){var l,d=this,D=y.p(i),O=$(e),T=(O.utcOffset()-this.utcOffset())*g,E=this-O,F=function(){return y.m(d,O)};switch(D){case C:l=F()/12;break;case v:l=F();break;case k:l=F()/3;break;case w:l=(E-T)/6048e5;break;case r:l=(E-T)/864e5;break;case h:l=E/_;break;case b:l=E/g;break;case M:l=E/m;break;default:l=E}return n?l:y.a(l)},t.daysInMonth=function(){return this.endOf(v).$D},t.$locale=function(){return s[this.$L]},t.locale=function(e,i){if(!e)return this.$L;var n=this.clone(),l=S(e,i,!0);return l&&(n.$L=l),n},t.clone=function(){return y.w(this.$d,this)},t.toDate=function(){return new Date(this.valueOf())},t.toJSON=function(){return this.isValid()?this.toISOString():null},t.toISOString=function(){return this.$d.toISOString()},t.toString=function(){return this.$d.toUTCString()},o}(),B=A.prototype;return $.prototype=B,[["$ms",f],["$s",M],["$m",b],["$H",h],["$W",r],["$M",v],["$y",C],["$D",I]].forEach(function(o){B[o[1]]=function(t){return this.$g(t,o[0],o[1])}}),$.extend=function(o,t){return o.$i||(o(t,A,$),o.$i=!0),$},$.locale=S,$.isDayjs=N,$.unix=function(o){return $(1e3*o)},$.en=s[x],$.Ls=s,$.p={},$})})(ue);var pe=ue.exports;const ne=me(pe),ye=3e4,$e=()=>{const[a,c]=te(!1),[m,g]=te("");se(()=>{const f=localStorage.getItem("lastKofiPrompt");if(!f||ne().diff(ne(f),"day")>=3){const M=setTimeout(()=>{c(!0),localStorage.setItem("lastKofiPrompt",ne().format("YYYYMMDD"))},ye);return()=>clearTimeout(M)}},[]),se(()=>{g(a?"translate-y-0 opacity-100":"translate-y-2 opacity-0")},[a]);const _=P(()=>{window.open("https://ko-fi.com/mk_tiling","_blank"),c(!1)},[]);return a?u("div",{className:`absolute bottom-4 right-4 transition-all duration-50 ${m}`,children:u("button",{className:"h-10 flex justify-center items-center rounded-full border md:border-2 border-neutral-900 bg-white px-3 text-neutral-900 hover:enabled:bg-blue-500 hover:enabled:text-white",onClick:_,children:["Enjoying exploring?",u("span",{className:"ml-1 font-bold",children:"Support on Ko-fi!"})]})}):null};function ge(a,c,m="application/octet-stream"){const g=new Blob([a],{type:m}),_=URL.createObjectURL(g),f=document.createElement("a");f.href=_,f.download=c,f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(_)}const be=`0
SECTION
2
HEADER
0
ENDSEC
0
SECTION
2
TABLES
0
ENDSEC
0
SECTION
2
BLOCKS
0
ENDSEC
0
SECTION
2
ENTITIES`,xe=`0
ENDSEC
0
EOF`;function ve(a){return[be,"0","LWPOLYLINE","8","0","90",`${a.length}`,"70","1",...a.map(([m,g])=>["10",m.toFixed(6),"20",g.toFixed(6)]).flat(),xe].join(`
`)}const le=(a,c)=>a%c?le(c,a%c):c,j=(a,c=0)=>Array.from({length:a},(m,g)=>c+g),Me=({x:a,y:c})=>`l${a.toFixed(4)} ${c.toFixed(4)}`,we=({x:a,y:c,r:m,sweep:g=!1})=>`a${m.toFixed(4)} ${m.toFixed(4)} 0 0 ${g?1:0} ${a.toFixed(4)} ${c.toFixed(4)}`,re=(a,c)=>`translate(${a.toFixed(4)} ${c.toFixed(4)})`,Se=a=>`rotate(${a.toFixed(4)})`,De=({m:a,k:c,n:m,offset:g,arc:_,unit:f,layer:M})=>{const b=le(a,c),h=a/b,r=c/b,w=m/b,v=W(()=>j(w).map(s=>f*Math.cos(2*Math.PI*s/w)),[w,f]),k=W(()=>j(w).map(s=>f*Math.sin(2*Math.PI*s/w)),[w,f]),C=W(()=>j(r).map(s=>v[s]).reduce((s,p)=>s+p),[r,v]),I=W(()=>j(r).map(s=>k[s]).reduce((s,p)=>s+p),[r,k]),H=W(()=>v[r]-v[0],[r,v]),X=W(()=>k[r]-k[0],[r,k]),Y=f/2/Math.sin(h*Math.PI/w),q=W(()=>{const s=_?we:Me;return[...j(r).map(p=>s({x:v[p*h%r],y:k[p*h%r],r:Y,sweep:!0})),s({x:v[r],y:k[r],r:Y,sweep:!0}),s({x:-v[0],y:-k[0],r:Y}),...j(r-1,1).map(p=>s({x:-v[(r-p)*h%r],y:-k[(r-p)*h%r],r:Y})),s({x:-v[r],y:-k[r],r:Y})].join("")},[h,r,_,v,k,Y]),U=P(s=>{const p=j(r).findIndex(N=>N*h%r==s%r);return j(p>=0?p:0).reduce(({x:N,y:S},$)=>({x:N+v[(($*h+r-s%r)%r+s)%w],y:S+k[(($*h+r-s%r)%r+s)%w]}),{x:0,y:0})},[h,r,w,v,k]),J=W(()=>{const s=2*Math.PI/w;return[...j(r).map(p=>[Math.cos(p*h%r*s),Math.sin(p*h%r*s)]),[Math.cos(r*s),Math.sin(r*s)],[-1,0],...j(r-1,1).map(p=>[-Math.cos((r-p)*h%r*s),-Math.sin((r-p)*h%r*s)])].reduce((p,[N,S])=>{const[$,y]=p.at(-1);return[...p,[$+N,y+S]]},[[0,0]])},[h,r,w]),x=P(()=>{ge(ve(J),"tile.dxf","application/dxf")},[J]);return u(de,{children:[u("div",{className:"relative -mx-4 md:mx-0 mb-1 md:mb-2",children:[u("svg",{viewBox:"-400 -400 800 800",className:"w-full h-auto",children:[u("rect",{x:"-400",y:"-400",width:"800",height:"800",className:"fill-blue-50"}),u("defs",{children:[u("path",{id:"prototile",d:`M0 0${q}z`}),u("g",{id:"wedge",children:j(M).map(s=>j(s+1).map(p=>u("g",{transform:re(s*C+p*H,s*I+p*X),children:u("use",{href:"#prototile"})})))})]}),u("g",{className:"stroke-2 stroke-neutral-900 fill-white","stroke-linejoin":"round",transform:`scale(1 -1) ${re(g?-f/2:0,0)}`,children:j(w).map(s=>{const{sx:p,sy:N}=(()=>{if(g&&2*s>=w){const{x:S,y:$}=U(s-w/2);return{sx:f-S,sy:-$}}else{const{x:S,y:$}=U(s);return{sx:S,sy:$}}})();return u("g",{transform:`${re(p,N)} ${Se(360*s/w)}`,children:u("use",{href:"#wedge",className:"hover:fill-blue-500"})})})})]}),u($e,{})]}),u("div",{className:"relative mb-1 md:mb-2 flex justify-center items-center",children:[u("span",{children:["(m, k, n) = (",a,", ",c,", ",m,")",b>1&&"*"]}),u("a",{className:"absolute right-0 px-1 cursor-pointer hidden md:inline",onClick:x,children:"DXF"})]})]})},oe={k:[2,50],t:[2,10],unit:[5,50,5],layer:[1,10]},ce=(a,c,m,g)=>c<=a&&a<=m&&(g==null||g>0&&(a-c)%g==0),_e=()=>{const[a,c]=te(!0),[m,g]=te({m:3,k:7,t:2,offset:!1,arc:!1,unit:20,layer:3}),_=P(x=>{const{m:s,k:p,t:N,offset:S,arc:$,unit:y,layer:A}=x,B=new URLSearchParams(Object.fromEntries(Object.entries({m:s,k:p,t:N,offset:S,arc:$,unit:y,layer:A}).filter(o=>o[1]!=null).map(([o,t])=>[o,t.toString()]))).toString();B!==location.hash&&history.replaceState(null,"",`#${B}`)},[]);se(()=>{const x=location.hash.replace(/^#/,""),{m:s,...p}=Object.fromEntries(new URLSearchParams(x).entries()),N=Object.fromEntries(Object.entries(p).map(([S,$])=>{if(["offset","arc"].includes(S))return["true","false"].includes($)?[S,$==="true"]:void 0;if(!Object.keys(oe).includes(S)||!$.match(/\d+/))return null;const y=Number($),[A,B,o]=oe[S];return ce(y,A,B,o)?[S,y]:null}).filter(S=>S!=null));if(s?.match(/\d+/)){const S=Number(s);ce(S,1,(N.k??m.k)-1)&&(N.m=S)}Object.keys(N).length>0&&g(S=>({...S,...N})),_(N),c(!1)},[]);const f=P(x=>{g(p=>({...p,...x}));const s=location.hash.replace(/^#/,"");_(Object.fromEntries([...new URLSearchParams(s).entries(),...Object.entries(x)]))},[]),{m:M,k:b,t:h,offset:r,arc:w,unit:v,layer:k}=m,C=r?2*(h*b-M):h*b,I=P(x=>{x<b&&f({m:x})},[b]),H=P(x=>{M>=x?f({m:x-1,k:x}):f({k:x})},[M]),X=P(x=>{f({t:x})},[]),Y=P(x=>{f({offset:x})},[]),q=P(x=>{f({arc:x})},[]),U=P(x=>{f({unit:x})},[]),J=P(x=>{f({layer:x})},[]);return{isLoading:a,m:M,k:b,t:h,n:C,offset:r,arc:w,unit:v,layer:k,setM:I,setK:H,setT:X,setOffset:Y,setArc:q,setUnit:U,setLayer:J}},Ne=()=>{const{isLoading:a,m:c,k:m,t:g,n:_,offset:f,arc:M,unit:b,layer:h,setM:r,setK:w,setT:v,setOffset:k,setArc:C,setUnit:I,setLayer:H}=_e();return a?u("div",{children:"Loading..."}):u("div",{children:[u(De,{m:c,k:m,n:_,offset:f,arc:M,unit:b,layer:h}),u("div",{className:"flex flex-col items-center",children:u("div",{className:"w-full max-w-[480px] flex flex-col gap-1 md:gap-2",children:[u(V,{label:"m",value:c,min:1,max:m-1,onChange:r}),u(V,{label:"k",value:m,min:2,max:50,onChange:w}),u(V,{label:"t",value:g,min:2,max:10,onChange:v}),u("div",{className:"w-full flex justify-evenly",children:[u(ie,{label:"offset",enabled:f,onToggle:k}),u(ie,{label:"arc",enabled:M,onToggle:C})]}),u("hr",{className:"my-1 md:my-2"}),u(V,{label:"unit",value:b,min:5,max:50,step:5,onChange:I}),u(V,{label:"layer",value:h,min:1,max:10,onChange:H})]})})]})};export{Ne as Playground};
