import{l as U,k as q}from"./preact.module.BW0qtBSs.js";import{T as $,q as v,d as z,y as B}from"./hooks.module.DSNKsvNR.js";var D=0;function s(n,e,i,l,y,u){e||(e={});var h,f,o=e;if("ref"in o)for(f in o={},e)f=="ref"?h=e[f]:o[f]=e[f];var t={type:n,props:o,key:i,ref:h,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--D,__i:-1,__u:0,__source:y,__self:u};if(typeof n=="function"&&(h=n.defaultProps))for(f in h)o[f]===void 0&&(o[f]=h[f]);return U.vnode&&U.vnode(t),t}const O=({label:n,value:e,min:i=0,max:l=10,step:y=1,onChange:u})=>{const h=`slider-${n.replace(/\s+/g,"-").toLowerCase()}`,f=()=>u(Math.max(i,e-y)),o=()=>u(Math.min(l,e+y));return s("div",{children:[s("label",{for:h,class:"block w-full text-sm",children:[n,": ",e]}),s("div",{class:"flex items-center gap-2",children:[s("button",{class:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:bg-blue-200","aria-label":"Decrease",onClick:f,children:"−"}),s("input",{id:h,type:"range",min:i,max:l,step:y,value:e,onInput:t=>u(Number(t.currentTarget.value)),class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),s("button",{class:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:bg-blue-200","aria-label":"Increase",onClick:o,children:"＋"})]})]})},E=({enabled:n,onToggle:e,label:i})=>s("div",{class:"py-2 flex items-center gap-1",children:[i&&s("span",{class:"text-sm",children:[i,":"]}),s("button",{type:"button",role:"switch","aria-checked":n,"aria-label":i,onClick:()=>e(!n),class:`w-12 h-6 rounded-full px-1 flex items-center transition-colors ${n?"bg-blue-500":"bg-gray-200"}`,children:s("span",{class:`w-4 h-4 rounded-full bg-white transform transition-transform ${n?"translate-x-6":"translate-x-0"}`})})]}),H=(n,e)=>n%e?H(e,n%e):e,k=(n,e=0)=>Array.from({length:n},(i,l)=>e+l),G=({x:n,y:e})=>`l${n.toFixed(4)} ${e.toFixed(4)}`,J=({x:n,y:e,r:i,sweep:l=!1})=>`a${i.toFixed(4)} ${i.toFixed(4)} 0 0 ${l?1:0} ${n.toFixed(4)} ${e.toFixed(4)}`,L=(n,e)=>`translate(${n.toFixed(4)} ${e.toFixed(4)})`,K=n=>`rotate(${n.toFixed(4)})`,Q=({m:n,k:e,n:i,offset:l,arc:y,unit:u,layer:h})=>{const f=H(n,e),o=n/f,t=e/f,m=i/f,x=$(()=>k(m).map(r=>u*Math.cos(2*Math.PI*r/m)),[m,u]),g=$(()=>k(m).map(r=>u*Math.sin(2*Math.PI*r/m)),[m,u]),w=$(()=>k(t).map(r=>x[r]).reduce((r,a)=>r+a),[t,x]),j=$(()=>k(t).map(r=>g[r]).reduce((r,a)=>r+a),[t,g]),F=$(()=>x[t]-x[0],[t,x]),T=$(()=>g[t]-g[0],[t,g]),_=u/2/Math.sin(o*Math.PI/m),C=$(()=>{const r=y?J:G;return[...k(t).map(a=>r({x:x[a*o%t],y:g[a*o%t],r:_,sweep:!0})),r({x:x[t],y:g[t],r:_,sweep:!0}),r({x:-x[0],y:-g[0],r:_}),...k(t-1,1).map(a=>r({x:-x[(t-a)*o%t],y:-g[(t-a)*o%t],r:_})),r({x:-x[t],y:-g[t],r:_})].join("")},[o,t,y,x,g,_]),c=v(r=>{const a=k(t).findIndex(p=>p*o%t==r%t);return k(a>=0?a:0).reduce(({x:p,y:d},b)=>({x:p+x[((b*o+t-r%t)%t+r)%m],y:d+g[((b*o+t-r%t)%t+r)%m]}),{x:0,y:0})},[o,t,m,x,g]);return s(q,{children:[s("div",{class:"-mx-4 md:mx-0 mb-1 md:mb-2",children:s("svg",{viewBox:"-400 -400 800 800",class:"w-full h-auto",children:[s("rect",{x:"-400",y:"-400",width:"800",height:"800",class:"fill-blue-50"}),s("defs",{children:[s("path",{id:"prototile",d:`M0 0${C}z`}),s("g",{id:"wedge",children:k(h).map(r=>k(r+1).map(a=>s("g",{transform:L(r*w+a*F,r*j+a*T),children:s("use",{href:"#prototile"})})))})]}),s("g",{class:"stroke-2 stroke-neutral-900 fill-white","stroke-linejoin":"round",transform:`scale(1 -1) ${L(l?-u/2:0,0)}`,children:k(m).map(r=>{const{sx:a,sy:p}=(()=>{if(l&&2*r>=m){const{x:d,y:b}=c(r-m/2);return{sx:u-d,sy:-b}}else{const{x:d,y:b}=c(r);return{sx:d,sy:b}}})();return s("g",{transform:`${L(a,p)} ${K(360*r/m)}`,children:s("use",{href:"#wedge",class:"hover:fill-blue-500"})})})})]})}),s("div",{class:"text-center mb-1 md:mb-2",children:["(m, k, n) = (",n,", ",e,", ",i,")",f>1&&"*"]})]})},A={k:[2,50],t:[2,10],unit:[5,50,5],layer:[1,10]},R=(n,e,i,l)=>e<=n&&n<=i&&(l==null||l>0&&(n-e)%l==0),W=()=>{const[n,e]=z({m:3,k:7,t:2,offset:!1,arc:!1,unit:20,layer:3}),i=v(c=>{const{m:r,k:a,t:p,offset:d,arc:b,unit:M,layer:I}=c,S=new URLSearchParams(Object.fromEntries(Object.entries({m:r,k:a,t:p,offset:d,arc:b,unit:M,layer:I}).filter(P=>P[1]!=null).map(([P,N])=>[P,N.toString()]))).toString();S!==location.hash&&history.replaceState(null,"",`#${S}`)},[]);B(()=>{const c=location.hash.replace(/^#/,""),{m:r,...a}=Object.fromEntries(new URLSearchParams(c).entries()),p=Object.fromEntries(Object.entries(a).map(([d,b])=>{if(["offset","arc"].includes(d))return["true","false"].includes(b)?[d,b==="true"]:void 0;if(!Object.keys(A).includes(d)||!b.match(/\d+/))return null;const M=Number(b),[I,S,P]=A[d];return R(M,I,S,P)?[d,M]:null}).filter(d=>d!=null));if(r?.match(/\d+/)){const d=Number(r);R(d,1,(p.k??n.k)-1)&&(p.m=d)}Object.keys(p).length>0&&e(d=>({...d,...p})),i(p)},[]);const l=v(c=>{e(a=>({...a,...c}));const r=location.hash.replace(/^#/,"");i(Object.fromEntries([...new URLSearchParams(r).entries(),...Object.entries(c)]))},[]),{m:y,k:u,t:h,offset:f,arc:o,unit:t,layer:m}=n,x=f?2*(h*u-y):h*u,g=v(c=>{c<u&&l({m:c})},[u]),w=v(c=>{y>=c?l({m:c-1,k:c}):l({k:c})},[y]),j=v(c=>{l({t:c})},[]),F=v(c=>{l({offset:c})},[]),T=v(c=>{l({arc:c})},[]),_=v(c=>{l({unit:c})},[]),C=v(c=>{l({layer:c})},[]);return{m:y,k:u,t:h,n:x,offset:f,arc:o,unit:t,layer:m,setM:g,setK:w,setT:j,setOffset:F,setArc:T,setUnit:_,setLayer:C}},Z=()=>{const{m:n,k:e,t:i,n:l,offset:y,arc:u,unit:h,layer:f,setM:o,setK:t,setT:m,setOffset:x,setArc:g,setUnit:w,setLayer:j}=W();return s("div",{children:[s(Q,{m:n,k:e,n:l,offset:y,arc:u,unit:h,layer:f}),s("div",{class:"flex flex-col items-center",children:s("div",{class:"w-full max-w-[480px] flex flex-col gap-1 md:gap-2",children:[s(O,{label:"m",value:n,min:1,max:e-1,onChange:o}),s(O,{label:"k",value:e,min:2,max:50,onChange:t}),s(O,{label:"t",value:i,min:2,max:10,onChange:m}),s("div",{class:"w-full flex justify-evenly",children:[s(E,{label:"offset",enabled:y,onToggle:x}),s(E,{label:"arc",enabled:u,onToggle:g})]}),s("hr",{class:"my-1 md:my-2"}),s(O,{label:"unit",value:h,min:5,max:50,step:5,onChange:w}),s(O,{label:"layer",value:f,min:1,max:10,onChange:j})]})})]})};export{Z as Playground};
