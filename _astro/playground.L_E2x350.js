import{l as U,k as N}from"./preact.module.BW0qtBSs.js";import{T as $,q as v,d as q,y as z}from"./hooks.module.DSNKsvNR.js";var B=0;function s(n,e,o,l,y,u){e||(e={});var x,d,a=e;if("ref"in a)for(d in a={},e)d=="ref"?x=e[d]:a[d]=e[d];var t={type:n,props:a,key:o,ref:x,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--B,__i:-1,__u:0,__source:y,__self:u};if(typeof n=="function"&&(x=n.defaultProps))for(d in x)a[d]===void 0&&(a[d]=x[d]);return U.vnode&&U.vnode(t),t}const O=({label:n,value:e,min:o=0,max:l=10,step:y=1,onChange:u})=>{const x=`slider-${n.replace(/\s+/g,"-").toLowerCase()}`,d=()=>u(Math.max(o,e-y)),a=()=>u(Math.min(l,e+y)),t=e>o,f=e<l;return s("div",{children:[s("label",{for:x,class:"block w-full text-sm",children:[n,": ",e]}),s("div",{class:"flex items-center gap-2",children:[s("button",{class:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:enabled:bg-blue-200 disabled:opacity-50","aria-label":"Decrease",disabled:!t,onClick:d,children:"−"}),s("input",{id:x,type:"range",min:o,max:l,step:y,value:e,onInput:h=>u(Number(h.currentTarget.value)),class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),s("button",{class:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:enabled:bg-blue-200 disabled:opacity-50","aria-label":"Increase",disabled:!f,onClick:a,children:"＋"})]})]})},E=({enabled:n,onToggle:e,label:o})=>s("div",{class:"py-2 flex items-center gap-1",children:[o&&s("span",{class:"text-sm",children:[o,":"]}),s("button",{type:"button",role:"switch","aria-checked":n,"aria-label":o,onClick:()=>e(!n),class:`w-12 h-6 rounded-full px-1 flex items-center transition-colors ${n?"bg-blue-500":"bg-gray-200"}`,children:s("span",{class:`w-4 h-4 rounded-full bg-white transform transition-transform ${n?"translate-x-6":"translate-x-0"}`})})]}),D=(n,e)=>n%e?D(e,n%e):e,k=(n,e=0)=>Array.from({length:n},(o,l)=>e+l),G=({x:n,y:e})=>`l${n.toFixed(4)} ${e.toFixed(4)}`,J=({x:n,y:e,r:o,sweep:l=!1})=>`a${o.toFixed(4)} ${o.toFixed(4)} 0 0 ${l?1:0} ${n.toFixed(4)} ${e.toFixed(4)}`,L=(n,e)=>`translate(${n.toFixed(4)} ${e.toFixed(4)})`,K=n=>`rotate(${n.toFixed(4)})`,Q=({m:n,k:e,n:o,offset:l,arc:y,unit:u,layer:x})=>{const d=D(n,e),a=n/d,t=e/d,f=o/d,h=$(()=>k(f).map(r=>u*Math.cos(2*Math.PI*r/f)),[f,u]),g=$(()=>k(f).map(r=>u*Math.sin(2*Math.PI*r/f)),[f,u]),w=$(()=>k(t).map(r=>h[r]).reduce((r,i)=>r+i),[t,h]),j=$(()=>k(t).map(r=>g[r]).reduce((r,i)=>r+i),[t,g]),F=$(()=>h[t]-h[0],[t,h]),T=$(()=>g[t]-g[0],[t,g]),_=u/2/Math.sin(a*Math.PI/f),C=$(()=>{const r=y?J:G;return[...k(t).map(i=>r({x:h[i*a%t],y:g[i*a%t],r:_,sweep:!0})),r({x:h[t],y:g[t],r:_,sweep:!0}),r({x:-h[0],y:-g[0],r:_}),...k(t-1,1).map(i=>r({x:-h[(t-i)*a%t],y:-g[(t-i)*a%t],r:_})),r({x:-h[t],y:-g[t],r:_})].join("")},[a,t,y,h,g,_]),c=v(r=>{const i=k(t).findIndex(p=>p*a%t==r%t);return k(i>=0?i:0).reduce(({x:p,y:m},b)=>({x:p+h[((b*a+t-r%t)%t+r)%f],y:m+g[((b*a+t-r%t)%t+r)%f]}),{x:0,y:0})},[a,t,f,h,g]);return s(N,{children:[s("div",{class:"-mx-4 md:mx-0 mb-1 md:mb-2",children:s("svg",{viewBox:"-400 -400 800 800",class:"w-full h-auto",children:[s("rect",{x:"-400",y:"-400",width:"800",height:"800",class:"fill-blue-50"}),s("defs",{children:[s("path",{id:"prototile",d:`M0 0${C}z`}),s("g",{id:"wedge",children:k(x).map(r=>k(r+1).map(i=>s("g",{transform:L(r*w+i*F,r*j+i*T),children:s("use",{href:"#prototile"})})))})]}),s("g",{class:"stroke-2 stroke-neutral-900 fill-white","stroke-linejoin":"round",transform:`scale(1 -1) ${L(l?-u/2:0,0)}`,children:k(f).map(r=>{const{sx:i,sy:p}=(()=>{if(l&&2*r>=f){const{x:m,y:b}=c(r-f/2);return{sx:u-m,sy:-b}}else{const{x:m,y:b}=c(r);return{sx:m,sy:b}}})();return s("g",{transform:`${L(i,p)} ${K(360*r/f)}`,children:s("use",{href:"#wedge",class:"hover:fill-blue-500"})})})})]})}),s("div",{class:"text-center mb-1 md:mb-2",children:["(m, k, n) = (",n,", ",e,", ",o,")",d>1&&"*"]})]})},A={k:[2,50],t:[2,10],unit:[5,50,5],layer:[1,10]},R=(n,e,o,l)=>e<=n&&n<=o&&(l==null||l>0&&(n-e)%l==0),W=()=>{const[n,e]=q({m:3,k:7,t:2,offset:!1,arc:!1,unit:20,layer:3}),o=v(c=>{const{m:r,k:i,t:p,offset:m,arc:b,unit:M,layer:I}=c,S=new URLSearchParams(Object.fromEntries(Object.entries({m:r,k:i,t:p,offset:m,arc:b,unit:M,layer:I}).filter(P=>P[1]!=null).map(([P,H])=>[P,H.toString()]))).toString();S!==location.hash&&history.replaceState(null,"",`#${S}`)},[]);z(()=>{const c=location.hash.replace(/^#/,""),{m:r,...i}=Object.fromEntries(new URLSearchParams(c).entries()),p=Object.fromEntries(Object.entries(i).map(([m,b])=>{if(["offset","arc"].includes(m))return["true","false"].includes(b)?[m,b==="true"]:void 0;if(!Object.keys(A).includes(m)||!b.match(/\d+/))return null;const M=Number(b),[I,S,P]=A[m];return R(M,I,S,P)?[m,M]:null}).filter(m=>m!=null));if(r?.match(/\d+/)){const m=Number(r);R(m,1,(p.k??n.k)-1)&&(p.m=m)}Object.keys(p).length>0&&e(m=>({...m,...p})),o(p)},[]);const l=v(c=>{e(i=>({...i,...c}));const r=location.hash.replace(/^#/,"");o(Object.fromEntries([...new URLSearchParams(r).entries(),...Object.entries(c)]))},[]),{m:y,k:u,t:x,offset:d,arc:a,unit:t,layer:f}=n,h=d?2*(x*u-y):x*u,g=v(c=>{c<u&&l({m:c})},[u]),w=v(c=>{y>=c?l({m:c-1,k:c}):l({k:c})},[y]),j=v(c=>{l({t:c})},[]),F=v(c=>{l({offset:c})},[]),T=v(c=>{l({arc:c})},[]),_=v(c=>{l({unit:c})},[]),C=v(c=>{l({layer:c})},[]);return{m:y,k:u,t:x,n:h,offset:d,arc:a,unit:t,layer:f,setM:g,setK:w,setT:j,setOffset:F,setArc:T,setUnit:_,setLayer:C}},Z=()=>{const{m:n,k:e,t:o,n:l,offset:y,arc:u,unit:x,layer:d,setM:a,setK:t,setT:f,setOffset:h,setArc:g,setUnit:w,setLayer:j}=W();return s("div",{children:[s(Q,{m:n,k:e,n:l,offset:y,arc:u,unit:x,layer:d}),s("div",{class:"flex flex-col items-center",children:s("div",{class:"w-full max-w-[480px] flex flex-col gap-1 md:gap-2",children:[s(O,{label:"m",value:n,min:1,max:e-1,onChange:a}),s(O,{label:"k",value:e,min:2,max:50,onChange:t}),s(O,{label:"t",value:o,min:2,max:10,onChange:f}),s("div",{class:"w-full flex justify-evenly",children:[s(E,{label:"offset",enabled:y,onToggle:h}),s(E,{label:"arc",enabled:u,onToggle:g})]}),s("hr",{class:"my-1 md:my-2"}),s(O,{label:"unit",value:x,min:5,max:50,step:5,onChange:w}),s(O,{label:"layer",value:d,min:1,max:10,onChange:j})]})})]})};export{Z as Playground};
