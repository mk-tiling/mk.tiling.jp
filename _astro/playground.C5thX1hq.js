import{l as S,k as O}from"./preact.module.BW0qtBSs.js";import{T as y,q as P,d as b}from"./hooks.module.BKu84vyT.js";var U=0;function n(t,r,l,h,x,a){r||(r={});var m,c,o=r;if("ref"in o)for(c in o={},r)c=="ref"?m=r[c]:o[c]=r[c];var e={type:t,props:o,key:l,ref:m,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--U,__i:-1,__u:0,__source:x,__self:a};if(typeof t=="function"&&(m=t.defaultProps))for(c in m)o[c]===void 0&&(o[c]=m[c]);return S.vnode&&S.vnode(e),e}const M=({label:t,value:r,min:l=0,max:h=10,step:x=1,onChange:a})=>{const m=`slider-${t.replace(/\s+/g,"-").toLowerCase()}`,c=()=>a(Math.max(l,r-x)),o=()=>a(Math.min(h,r+x));return n("div",{children:[n("label",{for:m,class:"block w-full text-sm",children:[t,": ",r]}),n("div",{class:"flex items-center gap-2",children:[n("button",{class:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:bg-blue-200","aria-label":"Decrease",onClick:c,children:"−"}),n("input",{id:m,type:"range",min:l,max:h,step:x,value:r,onInput:e=>a(Number(e.currentTarget.value)),class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),n("button",{class:"w-8 h-8 flex justify-center items-center rounded-full bg-gray-200 hover:bg-blue-200","aria-label":"Increase",onClick:o,children:"＋"})]})]})},j=({enabled:t,onToggle:r,label:l})=>n("div",{class:"py-2 flex items-center gap-1",children:[l&&n("span",{class:"text-sm",children:[l,":"]}),n("button",{type:"button",role:"switch","aria-checked":t,"aria-label":l,onClick:()=>r(!t),class:`w-12 h-6 rounded-full px-1 flex items-center transition-colors ${t?"bg-blue-500":"bg-gray-200"}`,children:n("span",{class:`w-4 h-4 rounded-full bg-white transform transition-transform ${t?"translate-x-6":"translate-x-0"}`})})]}),A=(t,r)=>t%r?A(r,t%r):r,p=(t,r=0)=>Array.from({length:t},(l,h)=>r+h),q=({x:t,y:r})=>`l${t.toFixed(4)} ${r.toFixed(4)}`,z=({x:t,y:r,r:l,sweep:h=!1})=>`a${l.toFixed(4)} ${l.toFixed(4)} 0 0 ${h?1:0} ${t.toFixed(4)} ${r.toFixed(4)}`,C=(t,r)=>`translate(${t.toFixed(4)} ${r.toFixed(4)})`,B=t=>`rotate(${t.toFixed(4)})`,D=({m:t,k:r,n:l,offset:h,arc:x,unit:a,layer:m})=>{const c=A(t,r),o=t/c,e=r/c,i=l/c,u=y(()=>p(i).map(s=>a*Math.cos(2*Math.PI*s/i)),[i,a]),d=y(()=>p(i).map(s=>a*Math.sin(2*Math.PI*s/i)),[i,a]),_=y(()=>p(e).map(s=>u[s]).reduce((s,f)=>s+f),[e,u]),$=y(()=>p(e).map(s=>d[s]).reduce((s,f)=>s+f),[e,d]),F=y(()=>u[e]-u[0],[e,u]),T=y(()=>d[e]-d[0],[e,d]),g=a/2/Math.sin(o*Math.PI/i),L=y(()=>{const s=x?z:q;return[...p(e).map(f=>s({x:u[f*o%e],y:d[f*o%e],r:g,sweep:!0})),s({x:u[e],y:d[e],r:g,sweep:!0}),s({x:-u[0],y:-d[0],r:g}),...p(e-1,1).map(f=>s({x:-u[(e-f)*o%e],y:-d[(e-f)*o%e],r:g})),s({x:-u[e],y:-d[e],r:g})].join("")},[o,e,x,u,d,g]),I=P(s=>{const f=p(e).findIndex(k=>k*o%e==s%e);return p(f>=0?f:0).reduce(({x:k,y:w},v)=>({x:k+u[((v*o+e-s%e)%e+s)%i],y:w+d[((v*o+e-s%e)%e+s)%i]}),{x:0,y:0})},[o,e,i,u,d]);return n(O,{children:[n("div",{class:"-mx-4 md:mx-0 mb-1 md:mb-2",children:n("svg",{viewBox:"-400 -400 800 800",class:"w-full h-auto",children:[n("rect",{x:"-400",y:"-400",width:"800",height:"800",class:"fill-blue-50"}),n("defs",{children:[n("path",{id:"prototile",d:`M0 0${L}z`}),n("g",{id:"wedge",children:p(m).map(s=>p(s+1).map(f=>n("g",{transform:C(s*_+f*F,s*$+f*T),children:n("use",{href:"#prototile"})})))})]}),n("g",{class:"stroke-2 stroke-neutral-900 fill-white","stroke-linejoin":"round",transform:`scale(1 -1) ${C(h?-a/2:0,0)}`,children:p(i).map(s=>{const{sx:f,sy:k}=(()=>{if(h&&2*s>=i){const{x:w,y:v}=I(s-i/2);return{sx:a-w,sy:-v}}else{const{x:w,y:v}=I(s);return{sx:w,sy:v}}})();return n("g",{transform:`${C(f,k)} ${B(360*s/i)}`,children:n("use",{href:"#wedge",class:"hover:fill-blue-500"})})})})]})}),n("div",{class:"text-center mb-1 md:mb-2",children:["(m, k, n) = (",t,", ",r,", ",l,")",c>1&&"*"]})]})},G=()=>{const[t,r]=b(3),[l,h]=b(7),[x,a]=b(2),[m,c]=b(!1),[o,e]=b(!1),[i,u]=b(20),[d,_]=b(3),$=m?2*(x*l-t):x*l,F=P(g=>{g<l&&r(g)},[l]),T=P(g=>{t>=g&&r(g-1),h(g)},[t]);return{m:t,k:l,t:x,n:$,offset:m,arc:o,unit:i,layer:d,setM:F,setK:T,setT:a,setOffset:c,setArc:e,setUnit:u,setLayer:_}},H=()=>{const{m:t,k:r,t:l,n:h,offset:x,arc:a,unit:m,layer:c,setM:o,setK:e,setT:i,setOffset:u,setArc:d,setUnit:_,setLayer:$}=G();return n("div",{children:[n(D,{m:t,k:r,n:h,offset:x,arc:a,unit:m,layer:c}),n("div",{class:"flex flex-col items-center",children:n("div",{class:"w-full max-w-[480px] flex flex-col gap-1 md:gap-2",children:[n(M,{label:"m",value:t,min:1,max:r-1,onChange:o}),n(M,{label:"k",value:r,min:2,max:50,onChange:e}),n(M,{label:"t",value:l,min:2,max:10,onChange:i}),n("div",{class:"w-full flex justify-evenly",children:[n(j,{label:"offset",enabled:x,onToggle:u}),n(j,{label:"arc",enabled:a,onToggle:d})]}),n("hr",{class:"my-1 md:my-2"}),n(M,{label:"unit",value:m,min:5,max:50,step:5,onChange:_}),n(M,{label:"layer",value:c,min:1,max:10,onChange:$})]})})]})};export{H as Playground};
